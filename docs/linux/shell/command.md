---
nav:
  title: Linux
  order: 1
group:
  title: Shell ç¼–ç¨‹
  order: 5
title: å‘½ä»¤
order: 4
---

# å‘½ä»¤

åŸºæœ¬æ ¼å¼

```bash
$ command [options] [arguments]
```

```bash
#!/bin/bash
echo "Hello World !"
```

## å†…å»ºå‘½ä»¤

æ‰€è°“ Shell å†…å»ºå‘½ä»¤ï¼Œå°±æ˜¯ç”± Bash è‡ªèº«æä¾›çš„å‘½ä»¤ï¼Œè€Œä¸æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­çš„æŸä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ä¾‹å¦‚ï¼Œç”¨äºè¿›å…¥æˆ–è€…åˆ‡æ¢ç›®å½•çš„ cd å‘½ä»¤ï¼Œè™½ç„¶æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨å®ƒï¼Œä½†å¦‚æœä¸åŠ ä»¥æ³¨æ„å¾ˆéš¾æ„è¯†åˆ°å®ƒä¸æ™®é€šå‘½ä»¤çš„æ€§è´¨æ˜¯ä¸ä¸€æ ·çš„ï¼šè¯¥å‘½ä»¤å¹¶ä¸æ˜¯æŸä¸ªå¤–éƒ¨æ–‡ä»¶ï¼Œåªè¦åœ¨ Shell ä¸­ä½ å°±ä¸€å®šå¯ä»¥è¿è¡Œè¿™ä¸ªå‘½ä»¤ã€‚

å¯ä»¥ä½¿ç”¨ `type` æ¥ç¡®å®šä¸€ä¸ªå‘½ä»¤æ˜¯å¦æ˜¯å†…å»ºå‘½ä»¤ï¼š

```bash
$ type cd
cd is a Shell builtin

$ type ifconfig
ifconfig is /sbin/ifconfig
```

ç”±æ­¤å¯è§ï¼Œ`cd` æ˜¯ä¸€ä¸ª Shell å†…å»ºå‘½ä»¤ï¼Œè€Œ `ifconfig` æ˜¯ä¸€ä¸ªå¤–éƒ¨æ–‡ä»¶ï¼Œå®ƒçš„ä½ç½®æ˜¯ `/sbin/ifconfig`ã€‚

è¿˜è®°å¾—ç³»ç»Ÿå˜é‡ `$PATH` å—ï¼Ÿ`$PATH` å˜é‡åŒ…å«çš„ç›®å½•ä¸­å‡ ä¹èšé›†äº†ç³»ç»Ÿä¸­ç»å¤§å¤šæ•°çš„å¯æ‰§è¡Œå‘½ä»¤ï¼Œå®ƒä»¬éƒ½æ˜¯å¤–éƒ¨å‘½ä»¤ã€‚

é€šå¸¸æ¥è¯´ï¼Œå†…å»ºå‘½ä»¤ä¼šæ¯”å¤–éƒ¨å‘½ä»¤æ‰§è¡Œå¾—æ›´å¿«ï¼Œæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ä¸ä½†ä¼šè§¦å‘ç£ç›˜ `I/O`ï¼Œè¿˜éœ€è¦ `fork` å‡ºä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹æ¥æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæˆåå†é€€å‡ºã€‚è€Œæ‰§è¡Œå†…å»ºå‘½ä»¤ç›¸å½“äºè°ƒç”¨å½“å‰ Shell è¿›ç¨‹çš„ä¸€ä¸ªå‡½æ•°ã€‚

## alias

ä½¿ç”¨ `alias` å‘½ä»¤è‡ªå®šä¹‰åˆ«åçš„è¯­æ³•æ ¼å¼ï¼š

```bash
alias new_name='command'
```

æ¯”å¦‚ï¼Œä¸€èˆ¬çš„å…³æœºå‘½ä»¤ ``shutdown -h now` å†™èµ·æ¥æ¯”è¾ƒé•¿ï¼Œè¿™æ—¶å¯ä»¥é‡æ–°å®šä¹‰ä¸€ä¸ªå…³æœºå‘½ä»¤ï¼š

```bash
alias sd='shutdown -h now'
```

å†å¦‚ï¼Œé€šè¿‡ `date` å‘½ä»¤å¯ä»¥è·å¾—å½“å‰çš„ UNIX æ—¶é—´æˆ³ï¼Œå…·ä½“å†™æ³•ä¸º `date +%s`ï¼š

```bash
alias timestamp='date +%s'
```

åœ¨ä»£ç ä¸­ä½¿ç”¨ `alias` å‘½ä»¤å®šä¹‰çš„åˆ«ååªèƒ½åœ¨å½“å‰ Shell è¿›ç¨‹ä¸­ä½¿ç”¨ï¼Œåœ¨å­è¿›ç¨‹å’Œå…¶å®ƒè¿›ç¨‹ä¸­éƒ½ä¸èƒ½ä½¿ç”¨ã€‚å½“å‰ Shell è¿›ç¨‹ç»“æŸåï¼Œåˆ«åä¹Ÿéšä¹‹æ¶ˆå¤±ã€‚

## echo

ç”¨äºåœ¨ç»ˆç«¯è¾“å‡ºå­—ç¬¦ä¸²ï¼Œå¹¶åœ¨æœ€åé»˜è®¤åŠ ä¸Šæ¢è¡Œç¬¦ã€‚

```bash
#!/bin/bash

name="tsejx"
url="https://github.com/tsejx"

# ç›´æ¥è¾“å‡ºå­—ç¬¦ä¸²
echo "Hello world!"
# è¾“å‡ºå˜é‡
echo $url
# åŒå¼•å·åŒ…å›´çš„å­—ç¬¦ä¸²ä¸­å¯ä»¥è§£æå˜é‡
echo "${name}çš„ç½‘å€æ˜¯ï¼š${url}"
# å•å¼•å·åŒ…å›´çš„å­—ç¬¦ä¸²ä¸èƒ½è§£æå˜é‡
echo '${name}çš„ç½‘å€æ˜¯ï¼š${url}'
```

## read

ç”¨äºæ ‡å‡†è¾“å…¥ä¸­è¯»å–æ•°æ®å¹¶èµ‹å€¼ç»™å˜é‡ã€‚å¦‚æœæ²¡æœ‰è¿›è¡Œé‡å®šå‘ï¼Œé»˜è®¤å°±æ˜¯ä»é”®ç›˜è¯»å–ç”¨æˆ·è¾“å…¥çš„æ•°æ®ï¼›å¦‚æœè¿›è¡Œäº†é‡å®šå‘ï¼Œé‚£ä¹ˆå¯ä»¥ä»ä¸­è¯»å–æ•°æ®ã€‚

```bash
read [-options] [variables]
```

- `options` è¡¨ç¤ºé€‰é¡¹
- `variables` è¡¨ç¤ºç”¨æ¥å­˜å‚¨æ•°æ®çš„å˜é‡ï¼Œå¯ä»¥æœ‰ä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥æœ‰å¤šä¸ª

ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œå¦‚æœæ²¡æœ‰æä¾›å˜é‡åï¼Œé‚£ä¹ˆè¯»å–çš„æ•°æ®å°†å­˜æ”¾åˆ°ç¯å¢ƒå˜é‡ `REPLY` ä¸­ã€‚

ğŸŒ° **ç¤ºä¾‹ï¼š**

```bash
#!/bin/bash

read -p "Enter some information > " name url age
echo "Websiteï¼š$name"
echo "Url: $url"
echo "Age: $age"
```

æ³¨æ„ï¼Œå¿…é¡»åœ¨ä¸€è¡Œå†…è¾“å…¥æ‰€æœ‰çš„å€¼ï¼Œä¸èƒ½æ¢è¡Œï¼Œå¦åˆ™åªèƒ½ç»™ç¬¬ä¸€ä¸ªå˜é‡èµ‹å€¼ï¼Œåç»­å˜é‡éƒ½ä¼šèµ‹å€¼å¤±è´¥ã€‚

**ç¤ºä¾‹ï¼šæŒ‡å®šæ—¶é—´å†…è¾“å…¥å¯†ç **

```bash
#!/bin/bash

if
  read -t 20 -sp "Enter password in 20 seconds >" pass1 && printf "\n" &&  #ç¬¬ä¸€æ¬¡è¾“å…¥å¯†ç 
  read -t 20 -sp "Enter password in 20 seconds> " pass2 && printf "\n" &&  #ç¬¬äºŒæ¬¡è¾“å…¥å¯†ç 
then
  echo "Valid password"
else
  echo "Invalid password"
fi
```

è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ `&&` ç»„åˆäº†å¤šä¸ªå‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤ä¼šä¾æ¬¡æ‰§è¡Œï¼Œå¹¶ä¸”ä»æ•´ä½“ä¸Šä½œä¸º `if` è¯­å¥çš„åˆ¤æ–­æ¡ä»¶ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼ˆé€€å‡ºçŠ¶æ€ä¸ºé 0 å€¼ï¼‰ï¼Œæ•´ä¸ªåˆ¤æ–­æ¡ä»¶å°±å¤±è´¥äº†ï¼Œåç»­çš„å‘½ä»¤ä¹Ÿå°±æ²¡æœ‰å¿…è¦æ‰§è¡Œäº†ã€‚

## exit

é€€å‡ºå½“å‰ Shell è¿›ç¨‹ï¼Œå¹¶è¿”å›ä¸€ä¸ªé€€å‡ºçŠ¶æ€ï¼›ä½¿ç”¨$?å¯ä»¥æ¥æ”¶è¿™ä¸ªé€€å‡ºçŠ¶æ€ã€‚

`exit` å‘½ä»¤å¯ä»¥æ¥å—ä¸€ä¸ªæ•´æ•°å€¼ä½œä¸ºå‚æ•°ï¼Œä»£è¡¨é€€å‡ºçŠ¶æ€ã€‚å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤çŠ¶æ€å€¼æ˜¯ 0ã€‚

`exit` é€€å‡ºçŠ¶æ€åªèƒ½æ˜¯ä¸€ä¸ªä»‹äº 0~255 ä¹‹é—´çš„æ•´æ•°ï¼Œå…¶ä¸­åªæœ‰ 0 è¡¨ç¤ºæˆåŠŸï¼Œå…¶å®ƒå€¼éƒ½è¡¨ç¤ºå¤±è´¥ã€‚

Shell è¿›ç¨‹æ‰§è¡Œå‡ºé”™æ—¶ï¼Œå¯ä»¥æ ¹æ®é€€å‡ºçŠ¶æ€æ¥åˆ¤æ–­å…·ä½“å‡ºç°äº†ä»€ä¹ˆé”™è¯¯ï¼Œæ¯”å¦‚æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®š 1 è¡¨ç¤ºæ–‡ä»¶ä¸å­˜åœ¨ï¼Œ2 è¡¨ç¤ºæ–‡ä»¶æ²¡æœ‰è¯»å–æƒé™ï¼Œ3 è¡¨ç¤ºæ–‡ä»¶ç±»å‹ä¸å¯¹ã€‚

```bash
#!/bin/bash
echo "befor exit"

exit 8

echo "after exit"
```

åªä¼šæ‰“å°å‡º `berfore exit`ï¼Œè¿™è¯´æ˜é‡åˆ° `exit` å‘½ä»¤åï¼Œ`test.sh` æ‰§è¡Œå°±ç»“æŸäº†ã€‚

> âš ï¸ æ³¨æ„ï¼Œexit è¡¨ç¤ºé€€å‡ºå½“å‰ Shell è¿›ç¨‹ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ–°è¿›ç¨‹ä¸­è¿è¡Œ test.shï¼Œå¦åˆ™å½“å‰ Shell ä¼šè¯ï¼ˆç»ˆç«¯çª—å£ï¼‰ä¼šè¢«å…³é—­ï¼Œæˆ‘ä»¬å°±æ— æ³•çœ‹åˆ°è¾“å‡ºç»“æœäº†ã€‚


## let

## expr

## bc

## test

`test` å‘½ä»¤ç”¨äºæ£€æµ‹æŸä¸ªæ¡ä»¶æ˜¯å¦æˆç«‹ã€‚

```bash
test expression
```

å½“ `test` åˆ¤æ–­ `expression` æˆç«‹æ—¶ï¼Œé€€å‡ºçŠ¶æ€ä¸º 0ï¼Œéæ¬§æ³½ä¸ºé 0 å€¼ã€‚

`test` å‘½ä»¤ä¹Ÿå¯ä»¥ç®€å†™ä¸º `[]`ï¼Œå®ƒçš„ç”¨æ³•ä¸ºï¼š

```bash
[expression]
```

### æ–‡ä»¶æ£€æµ‹

æ–‡ä»¶ç±»å‹åˆ¤æ–­

| é€‰é¡¹        | ä½œç”¨                                       |
| ----------- | ------------------------------------------ |
| -b filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦ä¸ºå—è®¾å¤‡æ–‡ä»¶ã€‚   |
| -c filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦ä¸ºå­—ç¬¦è®¾å¤‡æ–‡ä»¶ã€‚ |
| -d filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦ä¸ºç›®å½•æ–‡ä»¶ã€‚     |
| -e filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚                         |
| -f filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œäº•ä¸”æ˜¯å¦ä¸ºæ™®é€šæ–‡ä»¶ã€‚     |
| -L filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦ä¸ºç¬¦å·é“¾æ¥æ–‡ä»¶ã€‚ |
| -p filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦ä¸ºç®¡é“æ–‡ä»¶ã€‚     |
| -s filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦ä¸ºéç©ºã€‚         |
| -S filename | åˆ¤æ–­è¯¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦ä¸ºå¥—æ¥å­—æ–‡ä»¶ã€‚ |

æ–‡ä»¶æƒé™åˆ¤æ–­

| é€‰é¡¹        | ä½œç”¨                                         |
| ----------- | -------------------------------------------- |
| -r filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦æ‹¥æœ‰è¯»æƒé™ã€‚       |
| -w filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦æ‹¥æœ‰å†™æƒé™ã€‚       |
| -x filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦æ‹¥æœ‰æ‰§è¡Œæƒé™ã€‚     |
| -u filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦æ‹¥æœ‰ SUID æƒé™ã€‚   |
| -g filename | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦æ‹¥æœ‰ SGID æƒé™ã€‚   |
| -k filename | åˆ¤æ–­è¯¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦æ‹¥æœ‰ SBIT æƒé™ã€‚ |

æ–‡ä»¶æ¯”è¾ƒ

| é€‰é¡¹                    | ä½œç”¨                                                         |
| ----------------------- | ------------------------------------------------------------ |
| filename1 -nt filename2 | åˆ¤æ–­ filename1 çš„ä¿®æ”¹æ—¶é—´æ˜¯å¦æ¯” filename2 çš„æ–°ã€‚             |
| filename -ot filename2  | åˆ¤æ–­ filename1 çš„ä¿®æ”¹æ—¶é—´æ˜¯å¦æ¯” filename2 çš„æ—§ã€‚             |
| filename1 -ef filename2 | åˆ¤æ–­ filename1 æ˜¯å¦å’Œ filename2 çš„ inode å·ä¸€è‡´ï¼Œå¯ä»¥ç†è§£ä¸ºä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä¸ºåŒä¸€ä¸ªæ–‡ä»¶ã€‚è¿™ä¸ªåˆ¤æ–­ç”¨äºåˆ¤æ–­ç¡¬é“¾æ¥æ˜¯å¾ˆå¥½çš„æ–¹æ³• |

ğŸŒ° **ç¤ºä¾‹ï¼š**

```bash
#!/bin/bash

read filename
read url

if test -w $filename && test -n $url
then
    echo $url > $filename
    echo "å†™å…¥æˆåŠŸ"
else
    echo "å†™å…¥å¤±è´¥"
fi
```

### é€»è¾‘è¿ç®—

| é€‰é¡¹                       | ä½œç”¨                                                         |
| -------------------------- | ------------------------------------------------------------ |
| expression1 -a expression2 | é€»è¾‘ä¸ï¼Œè¡¨è¾¾å¼ expression1 å’Œ expression2 éƒ½æˆç«‹ï¼Œæœ€ç»ˆçš„ç»“æœæ‰æ˜¯æˆç«‹çš„ |
| expression1 -o expression2 | é€»è¾‘æˆ–ï¼Œè¡¨è¾¾å¼ expression1 å’Œ expression2 æœ‰ä¸€ä¸ªæˆç«‹ï¼Œæœ€ç»ˆçš„ç»“æœå°±æˆç«‹ã€‚ |
| !expression                | é€»è¾‘éï¼Œå¯¹ expression è¿›è¡Œå–åã€‚                             |

ğŸŒ° **ç¤ºä¾‹ï¼š**

```bash
#!/bin/bash
read str1
read str2
#æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©º
if [ -z "$str1" -o -z "$str2" ]  #ä½¿ç”¨ -o é€‰é¡¹å–ä»£ä¹‹å‰çš„ ||
then
    echo "å­—ç¬¦ä¸²ä¸èƒ½ä¸ºç©º"
    exit 0
fi
#æ¯”è¾ƒå­—ç¬¦ä¸²
if [ $str1 = $str2 ]
then
    echo "ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰"
else
    echo "ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸ç›¸ç­‰"
fi
```

