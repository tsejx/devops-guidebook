<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/devops-guidebook/umi.css" />
    <script>
      window.routerBase = "/devops-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.9
    </script>
    <title>&#x7F51;&#x7EDC;&#x7BA1;&#x7406;</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/linux/command/network" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/devops-icon.png&#x27;)" href="/devops-guidebook//">DevOps Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a aria-current="page" class="active" href="/devops-guidebook//linux">Linux</a></span><span><a href="/devops-guidebook//server">服务器</a></span><span><a href="/devops-guidebook//data-base">数据库</a></span><span><a href="/devops-guidebook//deploy">部署</a></span><span><a href="/devops-guidebook//code">代码管理</a></span><span><a href="/devops-guidebook//devops">DevOps</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/devops-icon.png&#x27;)" href="/devops-guidebook//"></a><h1>DevOps Guidebook</h1><p>DevOps 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a aria-current="page" class="active" href="/devops-guidebook//linux">Linux</a></li><li><a href="/devops-guidebook//server">服务器</a></li><li><a href="/devops-guidebook//data-base">数据库</a></li><li><a href="/devops-guidebook//deploy">部署</a></li><li><a href="/devops-guidebook//code">代码管理</a></li><li><a href="/devops-guidebook//devops">DevOps</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a aria-current="page" class="active" href="/devops-guidebook//linux">Linux 系统</a><ul><li><a href="/devops-guidebook//linux"><span>基本概要</span></a></li><li><a href="/devops-guidebook//linux/common-directory"><span>常见目录</span></a></li><li><a href="/devops-guidebook//linux/process"><span>进程</span></a></li><li><a href="/devops-guidebook//linux/file-permission"><span>文件权限</span></a></li><li><a href="/devops-guidebook//linux/package"><span>软件包</span></a></li><li><a href="/devops-guidebook//linux/firewall"><span>防火墙</span></a></li></ul></li><li><a aria-current="page" class="active" href="/devops-guidebook//linux/command">命令分类</a><ul><li><a href="/devops-guidebook//linux/command/system"><span>系统管理</span></a></li><li><a aria-current="page" class="active" href="/devops-guidebook//linux/command/network"><span>网络管理</span></a></li><li><a href="/devops-guidebook//linux/command/file"><span>文件管理</span></a></li><li><a href="/devops-guidebook//linux/command/directory"><span>目录管理</span></a></li><li><a href="/devops-guidebook//linux/command/devices"><span>设备管理</span></a></li><li><a href="/devops-guidebook//linux/command/package"><span>软件包管理</span></a></li><li><a href="/devops-guidebook//linux/command/utils"><span>常用工具</span></a></li><li><a href="/devops-guidebook//linux/command/collection"><span>指令合集</span></a></li><li><a href="/devops-guidebook//linux/command/environment-variable"><span>环境变量</span></a></li></ul></li><li><a href="/devops-guidebook//linux/shell">Shell 编程</a><ul><li><a href="/devops-guidebook//linux/shell"><span>概述</span></a></li><li><a href="/devops-guidebook//linux/shell/variable"><span>变量</span></a></li><li><a href="/devops-guidebook//linux/shell/type"><span>类型</span></a></li><li><a href="/devops-guidebook//linux/shell/command"><span>命令</span></a></li><li><a href="/devops-guidebook//linux/shell/structured-command"><span>结构化命令</span></a></li><li><a href="/devops-guidebook//linux/shell/function"><span>函数</span></a></li><li><a href="/devops-guidebook//linux/shell/sign"><span>特殊符号</span></a></li><li><a href="/devops-guidebook//linux/shell/shell-control"><span>脚本控制</span></a></li><li><a href="/devops-guidebook//linux/shell/tools"><span>实用工具</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="网络应用" data-depth="2"><a href="/devops-guidebook//linux/command/network#网络应用"><span>网络应用</span></a></li><li title="wget" data-depth="3"><a href="/devops-guidebook//linux/command/network#wget"><span>wget</span></a></li><li title="高级网络" data-depth="2"><a href="/devops-guidebook//linux/command/network#高级网络"><span>高级网络</span></a></li><li title="iptables" data-depth="3"><a href="/devops-guidebook//linux/command/network#iptables"><span>iptables</span></a></li><li title="网络测试" data-depth="2"><a href="/devops-guidebook//linux/command/network#网络测试"><span>网络测试</span></a></li><li title="host" data-depth="3"><a href="/devops-guidebook//linux/command/network#host"><span>host</span></a></li><li title="nslookup" data-depth="3"><a href="/devops-guidebook//linux/command/network#nslookup"><span>nslookup</span></a></li><li title="dig" data-depth="3"><a href="/devops-guidebook//linux/command/network#dig"><span>dig</span></a></li><li title="ping" data-depth="3"><a href="/devops-guidebook//linux/command/network#ping"><span>ping</span></a></li><li title="netstat" data-depth="3"><a href="/devops-guidebook//linux/command/network#netstat"><span>netstat</span></a></li><li title="网络安全" data-depth="2"><a href="/devops-guidebook//linux/command/network#网络安全"><span>网络安全</span></a></li><li title="ssh" data-depth="3"><a href="/devops-guidebook//linux/command/network#ssh"><span>ssh</span></a></li><li title="ssh-keygen" data-depth="3"><a href="/devops-guidebook//linux/command/network#ssh-keygen"><span>ssh-keygen</span></a></li><li title="ssh-add" data-depth="3"><a href="/devops-guidebook//linux/command/network#ssh-add"><span>ssh-add</span></a></li><li title="ssh-agent" data-depth="3"><a href="/devops-guidebook//linux/command/network#ssh-agent"><span>ssh-agent</span></a></li><li title="网络配置" data-depth="2"><a href="/devops-guidebook//linux/command/network#网络配置"><span>网络配置</span></a></li><li title="ifconfig" data-depth="3"><a href="/devops-guidebook//linux/command/network#ifconfig"><span>ifconfig</span></a></li><li title="route" data-depth="3"><a href="/devops-guidebook//linux/command/network#route"><span>route</span></a></li><li title="ip" data-depth="3"><a href="/devops-guidebook//linux/command/network#ip"><span>ip</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="网络管理"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#网络管理"><span class="icon,icon-link"></span></a>网络管理</h1><ul><li>网络应用<ul><li><code>curl</code> 利用 URL 规则在命令行下工作的文件传输工具</li><li><code>wget</code> 下载文件工具</li><li><code>telnet</code> 登录远程主机和管理</li></ul></li><li>高级网络<ul><li><code>ip</code> 网络配置工具</li><li><code>iptables</code> 防火墙软件</li></ul></li><li>网络测试<ul><li><code>iperf</code> 网络性能测试工具，可用于测试 TCP 和 UDO 带宽质量</li><li><code>host</code> 常用的分析域名查询工具</li><li><code>nslookup</code> 查询域名 DNS 信息的工具</li><li><code>dig</code> 域名查询工具</li><li><code>ping</code> 测试主机之间网络的联通性</li><li><code>netstat</code> 查看网络系统状态信息</li><li><code>traceroute</code> 追踪数据包在网络上的传输时的全部路径</li><li><code>tcpdump</code> 打印所有经过网络接口的数据包的头信息</li><li><code>netstat</code></li></ul></li><li>网络安全<ul><li><code>ssh</code> openssh 套件中的客户端连接工具</li><li><code>ssh-keyscan</code></li><li><code>ssh-copy-id</code></li><li><code>ssh-keygen</code> 为 SSH 生成、管理和转换认证密钥</li><li><code>ssh-add</code> 把专用密钥添加到 <code>ssh-agent</code> 的高速缓存中</li><li><code>ssh-agent</code> 控制用来保存公钥身份验证所使用的私钥程序</li></ul></li><li>网络配置<ul><li><code>ifconfig</code> 配置和显示系统网卡的网络参数</li><li><code>route</code> 查看网关命令</li></ul></li></ul><h2 id="网络应用"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#网络应用"><span class="icon,icon-link"></span></a>网络应用</h2><h3 id="wget"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#wget"><span class="icon,icon-link"></span></a>wget</h3><p>Linux 系统下载文件工具。</p><p>你想要在服务器上安装 JDK，不会现在本地下载下来，然后使用 scp 传到服务器上吧（有时候不得不这样）。wget 命令可以让你直接使用命令下载文件，并支持断点续传。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 下载单个文件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">wget</span><span class="token plain"> http://www.jsdig.com/testfile.zip</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 下载并以不同的文件名保存</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">wget</span><span class="token plain"> -O wordpress.zip http://www.jsdig.com/download.aspx?id</span><span class="token operator">=</span><span class="token number">1080</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 限速下载</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">wget</span><span class="token plain"> --limit-rate</span><span class="token operator">=</span><span class="token plain">300k http://www.jsdig.com/download.aspx?id</span><span class="token operator">=</span><span class="token number">1080</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 断点续传</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">wget</span><span class="token plain"> -c http://www.jsdig.com/testfile.zip</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># FTP 下载</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">wget</span><span class="token plain"> --ftp-user</span><span class="token operator">=</span><span class="token plain">USERNAME --ftp-parssword</span><span class="token operator">=</span><span class="token plain">PASSWORD url</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="高级网络"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#高级网络"><span class="icon,icon-link"></span></a>高级网络</h2><h3 id="iptables"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#iptables"><span class="icon,icon-link"></span></a>iptables</h3><p>防火墙分为软件防火墙和硬件防火墙。</p><p>防火墙又可以分为包过滤防火墙和应用层的防火墙。</p><ul><li>CentOS 6 默认的防火墙是 <code>iptables</code></li><li>CentOS 7 默认的防火墙是 <code>firewallD</code>（底层使用 <code>netfilter</code>）</li></ul><p>规则表：</p><ul><li>filter</li><li>nat</li><li>mangle</li><li>raw</li></ul><p>规则链：</p><ul><li>INPUT / OUTPUT / FORWARD</li><li>PREROUTING / POSTROUTING</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 查看 filter 表的几条链规则（INPUT 链可以看出开放了哪些端口）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -t filter -L -n</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># filter 表是默认查询的表，可以省略 -t 选项</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -L -n</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看 NAT 表的链规则</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -t nat -L -n</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看所有 iptables 规则</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -vnL</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 为 INPUT 链添加规则（开放 8080 端口）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -I INPUT -p tcp --dport </span><span class="token number">8080</span><span class="token plain"> -j ACCEPT</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 清除防火墙所有规则</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 删除所有自定义链</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -F</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -X</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -Z</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查找规则所在行号</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -L INPUT --line-numbers -n</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 根据行号删除过滤规则（关闭 8080 端口），下面的 1 是上面找到的规则所在的行号</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -D INPUT </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 放行 TCP 80 端口</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">firewall-cmd --add-port</span><span class="token operator">=</span><span class="token number">80</span><span class="token plain">/tcp --permanent</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 搜索 iptables 规则</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># $table 改为你想搜索的表，$string 改为你要搜索的字符串</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -L </span><span class="token variable">$table</span><span class="token plain"> -v -n </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">grep</span><span class="token plain"> </span><span class="token variable">$string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>-A 参数就看成是添加一条 INPUT 的规则 -p 指定是什么协议，常用的 tcp 协议，当然也有 udp 例如 53 端口的 DNS</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">iptables -A INPUT -p tcp --dport </span><span class="token number">22</span><span class="token plain"> -j ACCEPT</span></div><div class="token-line"><span class="token plain">iptables -A OUTPUT -p tcp --sport </span><span class="token number">22</span><span class="token plain"> -j ACCEPT</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>常用的防火墙规则：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 屏蔽某个 IP 地址</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -A INPUT -s xxx.xxx.xxx.xxx -j DROP</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 如果只想屏蔽来自某个 IP 地址的 TCP 流量，可以用 -p 指定协议</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -A INPUT -p tcp -s xxx.xxx.xxx.xxx -j DROP</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 取消屏蔽某个 IP 地址</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -D INPUT -s xxx.xxx.xxx.xxx -j DROP</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 屏蔽基于某个端口的传出连接</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -A OUTPUT -p tcp --dport xxx -j DROP</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 允许基于某个端口的传入连接</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -A INPUT -p tcp --dport xxx -j ACCEPT</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 将某个服务的流量转发到另一个端口</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -t nat -A PREROUTING -i eth0 -p tcp --dport </span><span class="token number">25</span><span class="token plain"> -j REDIRECT --to-port </span><span class="token number">2525</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># DDoS 屏蔽</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">iptables -A INPUT -p tcp --dport </span><span class="token number">80</span><span class="token plain"> -m limit --limit </span><span class="token number">100</span><span class="token plain">/minute --limit-burst </span><span class="token number">200</span><span class="token plain"> -j ACCEPT</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><code>iptables</code> 防火墙的配置文件：</p><ul><li><code>/etc/sysconfig/iptables</code></li><li>CentOS 6<ul><li><code>service iptables save | start | stop | restart</code></li></ul></li><li>CentOS 7<ul><li><code>yum install iptables-services</code></li></ul></li></ul><p>扩展资料：</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://wangchujiang.com/linux-command/c/iptables.html">Linux iptables 命令<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="http://www.codebelief.com/article/2017/08/linux-25-useful-iptables-firewall-rules/">Linux：25 个有用的 iptables 防火墙规则<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://www.cnblogs.com/mymelody/p/10490776.html">CentOS7 firewalld 打开关闭端口<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h2 id="网络测试"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#网络测试"><span class="icon,icon-link"></span></a>网络测试</h2><h3 id="host"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#host"><span class="icon,icon-link"></span></a>host</h3><p><code>host</code> 命令是常用的分析域名查询工具，可以用来测试域名系统工作是否正常。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 基本用法</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">host</span><span class="token plain"> taobao.com</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 显示详细的 DNS 信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">host</span><span class="token plain"> -a taobao.com</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="nslookup"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#nslookup"><span class="icon,icon-link"></span></a>nslookup</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 查询域名 的 A 记录</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># - domain 查询的域名</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># - dns-server 指定解析的 DNS 服务器</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nslookup</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">domain</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">dns-server</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nslookup</span><span class="token plain"> baidu.com</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nslookup</span><span class="token plain"> baidu.com </span><span class="token number">8.8</span><span class="token plain">.8.8</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查询其他记录</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nslookup</span><span class="token plain"> -qt </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">type</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">domain</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nslookup</span><span class="token plain"> -qt</span><span class="token operator">=</span><span class="token plain">mx baidu.com </span><span class="token number">8.8</span><span class="token plain">.8.8</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查询更距离的信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nslookup</span><span class="token plain"> -d </span><span class="token operator">&lt;</span><span class="token plain">domain</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nslookup</span><span class="token plain"> -d baidu.com</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 完全响应信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nslookup</span><span class="token plain"> -debug baidu.com</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><code>type</code> 参数：</p><ul><li><code>A</code>：地址记录</li><li><code>AAAA</code>：地址记录</li><li><code>CNAME</code>：别名记录</li></ul><p>建议使用 <a href="/devops-guidebook//linux/command/network#dig">dig</a> 替代 <code>nslookup</code> 命令。</p><h3 id="dig"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#dig"><span class="icon,icon-link"></span></a>dig</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 基本用法</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">dig</span><span class="token plain"> taobao.com</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 反向解析</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">dig</span><span class="token plain"> -x </span><span class="token number">140.205</span><span class="token plain">.94.189</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看域授权的 DNS 服务器</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">dig</span><span class="token plain"> taobao.com +nssearch</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="ping"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#ping"><span class="icon,icon-link"></span></a>ping</h3><p>用于检测网络的联通情况和分析网络速度，并根据域名得到服务器 IP（不包括那些禁 ping 的网站）</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 检查网络联通</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ping</span><span class="token plain"> xx.xx.xx.xx</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ping</span><span class="token plain"> taobao.com</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="netstat"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#netstat"><span class="icon,icon-link"></span></a>netstat</h3><p><code>netstat</code> 命令用于显示与 IP、TCP、UDP 和 ICMP 协议相关的统计数据，一般用于检验本机各端口的网络连接情况。<code>netstat</code> 是在内核中访问网络及相关信息的程序，它能提供 TCP 连接，TCP 和 UDP 监听，进程内存管理的相关报告。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">netstat</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>从整理上来看，<code>netstat</code> 输出结果可以分为两个部分：</p><ul><li>Active Internet connections，称为有源 TCP 连接，其中 <code>Recv-Q</code> 和 <code>Send-Q</code> 指的是接收队列和发送队列。这些数字一版都应该是 0。如果不是则表示软件包正在队列中堆积。这种情况只能在非常少的情况见到。</li><li>Active UNIX domain sockets，称为有源 Unix 域套接口（和网络套接字一样，但是只能用于本机通信，性能可以提高一倍）</li></ul><p>Proto 显示连接使用的协议，RefCnt 表示连接到本套接口上的进程号，Types 显示套接口的类型，State 显示套接口当前的状态，Path 表示连接到套接口的其它进程使用的路径名。</p><p><strong>状态说明：</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 侦听来自远方的TCP端口的连接请求</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">LISTEN</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 再发送连接请求后等待匹配的连接请求（如果有大量这样的状态包，检查是否中招了）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">SYN-SENT：</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 再收到和发送一个连接请求后等待对方对连接请求的确认（如有大量此状态，估计被flood攻击了）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">SYN-RECEIVED：</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 代表一个打开的连接</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ESTABLISHED：</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 等待远程TCP连接中断请求，或先前的连接中断请求的确认</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">FIN-WAIT-1：</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 从远程TCP等待连接中断请求</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">FIN-WAIT-2：</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 等待从本地用户发来的连接中断请求</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">CLOSE-WAIT：</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 等待远程TCP对连接中断的确认</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">CLOSING：</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 等待原来的发向远程TCP的连接中断请求的确认（不是什么好东西，此项出现，检查是否被攻击）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">LAST-ACK：</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 等待足够的时间以确保远程TCP接收到连接中断请求的确认</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">TIME-WAIT：</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 没有任何连接状态</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">CLOSED：</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 显示网卡列表</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -i</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 显示网络统计</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -s</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 显示以太网统计数据（包括传送的数据报的总字节数、错误数、删除数、数据报和数量和广播的数量）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -e</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 常用组合（l:listening;n:num;t:tcp;u:udp;p:process）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -lntup</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 显示路由信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -r</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 显示机器中网络连接各个状态个数</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -lant</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 把状态取出来后使用 uniq -c 统计后再进行排序</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -ant </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">awk</span><span class="token plain"> </span><span class="token string">&#x27;{print </span><span class="token string variable">$6</span><span class="token string">}&#x27;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">sort</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">uniq</span><span class="token plain"> -c</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看连接某服务端口最多的 IP 地址</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -ant </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">grep</span><span class="token plain"> </span><span class="token string">&quot;192.168.25.*&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">awk</span><span class="token plain"> </span><span class="token string">&#x27;{print </span><span class="token string variable">$5</span><span class="token string">}&#x27;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">awk</span><span class="token plain"> -F: </span><span class="token string">&#x27;{print </span><span class="token string variable">$1</span><span class="token string">}&#x27;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">sort</span><span class="token plain"> -nr </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">uniq</span><span class="token plain"> -c</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 找出程序运行的端口</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -ap </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">grep</span><span class="token plain"> </span><span class="token function">ssh</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 或者</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -alnt </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">grep</span><span class="token plain"> tcp</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 根据端口查看这个进程的 PID</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">netstat</span><span class="token plain"> -lnp </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">grep</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>此命令，在找一些本地起了什么端口之类的问题上，作用很大。</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://www.cnblogs.com/ftl1012/p/netstat.html">Linux netstat 命令详解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h2 id="网络安全"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#网络安全"><span class="icon,icon-link"></span></a>网络安全</h2><h3 id="ssh"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#ssh"><span class="icon,icon-link"></span></a>ssh</h3><p>ssh 命令是 openssh 套件中的客户端连接工具，可以给予 ssh 加密协议实现安全的远程登录服务器。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># ssh 连接远程主机 `ssh name@ip`</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 默认连接到目标主机的 22 端口</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ssh</span><span class="token plain"> user@hostname</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># ssh 连接远主机并指定端口</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ssh</span><span class="token plain"> -p </span><span class="token number">10022</span><span class="token plain"> user@hostname</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 打开调试模式</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ssh</span><span class="token plain"> -v user@hostname</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 对所有请求压缩</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 所有通过 ssh 发送或接收的数据将会被压缩，并且仍然是加密的。</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ssh</span><span class="token plain"> -C user@hostname</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 指定 ssh 源地址</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">如果你的 </span><span class="token function">ssh</span><span class="token plain"> 客户端多于两个以上的 IP 地址，可以使用 </span><span class="token variable">`</span><span class="token variable">-b</span><span class="token variable">`</span><span class="token plain"> 选项来指定一个 IP地址。</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 登录远程主机后执行某个命令</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ssh</span><span class="token plain"> username@hostname </span><span class="token string">&quot;ls /home/omd&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 登录远程服务器后执行某个脚本</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ssh</span><span class="token plain"> username@hostname -t </span><span class="token string">&quot;bash/home/omd/ftl.bash&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>查看 ssh 密钥目录</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 当前用户的 .ssh 目录</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ll /root/.ssh/known_hosts</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># ssh 配置文件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">cat</span><span class="token plain"> /etc/ssh/sshd_config</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 开启 ssh 服务</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">service</span><span class="token plain"> sshd start</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 关闭 ssh 服务</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">service</span><span class="token plain"> sshd stop</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 在 Github 添加了公钥后进行连接，用于验证 Key</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ssh</span><span class="token plain"> -T git@github.com</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="ssh-keygen"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#ssh-keygen"><span class="icon,icon-link"></span></a>ssh-keygen</h3><p>查看是否已经存在 SSH 密钥：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token builtin class-name">cd</span><span class="token plain"> ~/.ssh</span></div><div class="token-line"><span class="token plain"></span><span class="token function">ls</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>如果，提示不存在此目录，则进行第二步操作，否则，你本机已经存在 SSH 公钥和私钥，可以略过第二步，直接进入第三步操作。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 生成 SSH 秘钥</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh-keygen -t rsa -C </span><span class="token string">&quot;your_email@example.com&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><ul><li><code>-t</code>：指定密钥类型，默认是 RSA，可以省略</li><li><code>-C</code>：设置注释文字，比如邮箱</li><li><code>-f</code>：指定密钥文件存储文件名</li></ul><p>根据提示，需要指定文件位置和密码，如果是你足够放心，其实都可以直接回车，不需要什么密码。执行完以后，可在 <code>/C/Users/you/.ssh/</code> 路径下看到刚生成的文件：<code>id_rsa</code> 和 <code>id_rsa.pub</code>，即公钥和私钥。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 查看是否已经添加了对应主机的 SSH 密钥</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh-keygen -F </span><span class="token function">hostname</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 删除对应主机的 SSH 访问密钥</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh-keygen -R </span><span class="token function">hostname</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="ssh-add"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#ssh-add"><span class="icon,icon-link"></span></a>ssh-add</h3><p><code>ssh-add</code> 命令用于把专用密钥添加到 <code>ssh-agent</code> 的高速缓存中。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 把专用密钥添加到 ssh-agent 的高速缓存中</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh-add ~/.ssh/id_rsa</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 从 ssh-agent 中删除密钥</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh-add -d ~/.ssh/id_xxx.pub</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 删除 ssh-agent 中所有密钥</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh-add -D</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看 ssh-agent 中的密钥</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh-add -l</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看 ssh-agent 中的公钥</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh-add -L</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 设置密钥超时时间，超时 ssh-agent 将自动卸载密钥</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh-add -t </span><span class="token operator">&lt;</span><span class="token plain">life</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="ssh-agent"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#ssh-agent"><span class="icon,icon-link"></span></a>ssh-agent</h3><p><code>ssh-agent</code> 命令是一种控制用来保存公钥身份验证所使用的私钥程序。</p><p><code>ssh-agent</code> 在 X 会话或登录会话之初启动，所有其他窗口或程序则以客户端程序的身份启动并加入到 <code>ssh-agent</code> 程序中。通过使用环境变量，可定位代理并在登录到其他使用 <code>ssh</code> 机器上时使用代理自动进行身份验证。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 生成 Bourne Shell 风格命令输出</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ssh-agent -s</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="网络配置"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#网络配置"><span class="icon,icon-link"></span></a>网络配置</h2><h3 id="ifconfig"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#ifconfig"><span class="icon,icon-link"></span></a>ifconfig</h3><p><code>ifconfig</code> 是 Linux 的网络状态查看命令</p><p>查看 IP 地址，替代品是 <code>ip addr</code> 命令。</p><p><code>eth0</code> 第一块网卡（网络接口）</p><p>你的第一个网络接口可能叫做下面的名字：</p><ul><li><code>eno1</code>：板载网卡</li><li><code>ens33</code>：PCI-E 网卡</li><li><code>enp0s3</code>：无法获取物理信息的 PCI-E 网卡</li></ul><p>CentOS 7 使用了一致性网络设备命名，以上都不匹配则使用 <code>eth0</code>。</p><p>网络接口命名修改</p><p>网卡命名规则受 biosdevname 和 net.ifnames 两个参数影响。</p><p>编辑 <code>/etc/default/grub</code> 文件，增加 <code>biosdevname=0 net.ifnames=0</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 查看网络配置</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ifconfig</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">lo0: </span><span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">804</span><span class="token operator file-descriptor important">9</span><span class="token operator">&lt;</span><span class="token plain">UP,LOOPBACK,RUNNING,MULTICAST</span><span class="token operator">&gt;</span><span class="token plain"> mtu </span><span class="token number">16384</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token assign-left variable">options</span><span class="token operator">=</span><span class="token number">120</span><span class="token operator file-descriptor important">3</span><span class="token operator">&lt;</span><span class="token plain">RXCSUM,TXCSUM,TXSTATUS,SW_TIMESTAMP</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">inet </span><span class="token number">127.0</span><span class="token plain">.0.1 netmask 0xff000000</span></div><div class="token-line"><span class="token plain">inet6 ::1 prefixlen </span><span class="token number">128</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">inet6 fe80::1%lo0 prefixlen </span><span class="token number">64</span><span class="token plain"> scopeid 0x1</span></div><div class="token-line"><span class="token plain">nd6 </span><span class="token assign-left variable">options</span><span class="token operator">=</span><span class="token number">20</span><span class="token operator file-descriptor important">1</span><span class="token operator">&lt;</span><span class="token plain">PERFORMNUD,DAD</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><ul><li><code>en5</code>：网卡名称</li><li><code>inet</code>：网卡 IP 地址</li><li><code>netmask</code>：对应子网掩码</li><li><code>ether</code>：网卡 MAC 地址</li><li><code>RX &amp; TX</code>：发送/接受数据大小</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 修改网卡后重启</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">reboot</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>修改网络配置</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">ifconfig</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">接口</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">IP地址</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">netmask 子网掩码</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ifup</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">接口</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ifdown</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">接口</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="route"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#route"><span class="icon,icon-link"></span></a>route</h3><p><code>route</code> 命令用于显示并设置 Linux 内核中的网络路由表。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 不执行 DNS 反向查找，直接显示数字形式的 IP 地址</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">route -n</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 新增一条到达 244.0.0.0 的路由</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">route </span><span class="token function">add</span><span class="token plain"> -net </span><span class="token number">224.0</span><span class="token plain">.0.0 netmask </span><span class="token number">240.0</span><span class="token plain">.0.0 dev eth0</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 屏蔽一条路由，目的地为 244.x.x.x 将被拒绝</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">route </span><span class="token function">add</span><span class="token plain"> -net </span><span class="token number">224.0</span><span class="token plain">.0.0 netmask </span><span class="token number">240.0</span><span class="token plain">.0.0 reject</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="ip"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//linux/command/network#ip"><span class="icon,icon-link"></span></a>ip</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># ifconfig</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ip</span><span class="token plain"> addr </span><span class="token function">ls</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># ifup eth0</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ip</span><span class="token plain"> </span><span class="token function">link</span><span class="token plain"> </span><span class="token builtin class-name">set</span><span class="token plain"> dev eth0 up</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># ifconfig eth1 10.0.0.1 netmask 255.255.255.0</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ip</span><span class="token plain"> addr </span><span class="token function">add</span><span class="token plain"> </span><span class="token number">10.0</span><span class="token plain">.0.1/24 dev eth1</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># route add -net 10.0.0.0 netmask 255.255.255.0 gw 192.168.0.1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ip</span><span class="token plain"> route </span><span class="token function">add</span><span class="token plain"> </span><span class="token number">10.0</span><span class="token plain">.0/24 via </span><span class="token number">192.168</span><span class="token plain">.0.1</span></div><div class="token-line"><span class="token plain"></span></div></pre></div></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook/edit/master/docs/linux/command/network.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last update: ">1/21/2021, 02:51:50</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/devops-guidebook/umi.js"></script>
    <script src="/devops-guidebook/docs__linux__command__network.md.js"></script>
  </body>
</html>
