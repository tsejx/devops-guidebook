<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/devops-guidebook/umi.css" />
    <script>
      window.routerBase = "/devops-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.9
    </script>
    <title>&#x914D;&#x7F6E;&#x6A21;&#x5757;</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/server/nginx/modules" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/devops-icon.png&#x27;)" href="/devops-guidebook//">DevOps Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a href="/devops-guidebook//linux">Linux</a></span><span><a aria-current="page" class="active" href="/devops-guidebook//server">服务器</a></span><span><a href="/devops-guidebook//deploy">部署</a></span><span><a href="/devops-guidebook//code">代码管理</a></span><span><a href="/devops-guidebook//devops">DevOps</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/devops-icon.png&#x27;)" href="/devops-guidebook//"></a><h1>DevOps Guidebook</h1><p>DevOps 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/devops-guidebook//linux">Linux</a></li><li><a aria-current="page" class="active" href="/devops-guidebook//server">服务器</a></li><li><a href="/devops-guidebook//deploy">部署</a></li><li><a href="/devops-guidebook//code">代码管理</a></li><li><a href="/devops-guidebook//devops">DevOps</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a aria-current="page" class="active" href="/devops-guidebook//server/nginx">Nginx</a><ul><li><a href="/devops-guidebook//server/nginx"><span>基本概要</span></a></li><li><a href="/devops-guidebook//server/nginx/install"><span>安装教程</span></a></li><li><a href="/devops-guidebook//server/nginx/command-line"><span>命令行指令</span></a></li><li><a href="/devops-guidebook//server/nginx/configuration-grammar"><span>配置语法</span></a></li><li><a aria-current="page" class="active" href="/devops-guidebook//server/nginx/modules"><span>配置模块</span></a></li><li><a href="/devops-guidebook//server/nginx/static-resource-server"><span>静态资源服务器</span></a></li><li><a href="/devops-guidebook//server/nginx/proxy-service"><span>代理服务器</span></a></li><li><a href="/devops-guidebook//server/nginx/load-balance"><span>负载均衡</span></a></li><li><a href="/devops-guidebook//server/nginx/dynamic-cache"><span>动态缓存</span></a></li><li><a href="/devops-guidebook//server/nginx/rewrite"><span>地址重定向</span></a></li><li><a href="/devops-guidebook//server/nginx/https-service"><span>HTTPS 服务</span></a></li><li><a href="/devops-guidebook//server/nginx/log"><span>访问日志</span></a></li><li><a href="/devops-guidebook//server/nginx/architect"><span>架构原理</span></a></li><li><a href="/devops-guidebook//server/nginx/practical-configuration"><span>实用配置</span></a></li><li><a href="/devops-guidebook//server/nginx/best-practice"><span>最佳实践</span></a></li></ul></li><li><a href="/devops-guidebook//server/elk">ELK</a><ul><li><a href="/devops-guidebook//server/elk"><span>ELK</span></a></li><li><a href="/devops-guidebook//server/elk/elasticsearch"><span>Elasticsearch</span></a></li><li><a href="/devops-guidebook//server/elk/logstash"><span>Logstash</span></a></li><li><a href="/devops-guidebook//server/elk/filebeat"><span>Filebeat</span></a></li><li><a href="/devops-guidebook//server/elk/kibana"><span>Kibana</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="官方模块" data-depth="3"><a href="/devops-guidebook//server/nginx/modules#官方模块"><span>官方模块</span></a></li><li title="upstream" data-depth="2"><a href="/devops-guidebook//server/nginx/modules#upstream"><span>upstream</span></a></li><li title="server" data-depth="3"><a href="/devops-guidebook//server/nginx/modules#server"><span>server</span></a></li><li title="keepalive" data-depth="3"><a href="/devops-guidebook//server/nginx/modules#keepalive"><span>keepalive</span></a></li><li title="keepalive_requests" data-depth="3"><a href="/devops-guidebook//server/nginx/modules#keepalive_requests"><span>keepalive_requests</span></a></li><li title="keepalive_timeout" data-depth="3"><a href="/devops-guidebook//server/nginx/modules#keepalive_timeout"><span>keepalive_timeout</span></a></li><li title="proxy_pass" data-depth="2"><a href="/devops-guidebook//server/nginx/modules#proxy_pass"><span>proxy_pass</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="配置模块"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//server/nginx/modules#配置模块"><span class="icon,icon-link"></span></a>配置模块</h1><p>Nginx 中的模块分为：</p><ul><li>官方模块</li><li>第三方模块</li></ul><h3 id="官方模块"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//server/nginx/modules#官方模块"><span class="icon,icon-link"></span></a>官方模块</h3><ul><li>基本模块<ul><li>HTTP Core 模块 <a target="_blank" rel="noopener noreferrer" href="http://tengine.taobao.org/nginx_docs/cn/docs/http/ngx_http_core_module.html">ngx_http_core_module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>HTTP Upstream 模块 <a target="_blank" rel="noopener noreferrer" href="">ngx_http_upstream_module</a></li><li>HTTP Auth Basic 模块 <a target="_blank" rel="noopener noreferrer" href="">ngx_http_auth_basic_module</a></li><li>HTTP AutoIndex 模块 <a target="_blank" rel="noopener noreferrer" href="">ngx_http_autoindex_module</a></li><li>Browser <a target="_blank" rel="noopener noreferrer" href="">ngx_http_browser_module</a></li><li>Charset <a target="_blank" rel="noopener noreferrer" href="">ngx_http_charset_module</a></li><li>Empty GIF</li><li>FastCGI</li><li>Geo</li><li>Gzip <a target="_blank" rel="noopener noreferrer" href="http://nginx.org/en/docs/http/ngx_http_gzip_module.html">ngx_http_gzip_module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>HTTP Headers 模块 <a target="_blank" rel="noopener noreferrer" href="http://tengine.taobao.org/nginx_docs/cn/docs/http/ngx_http_headers_module.html">ngx_http_headers_module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>HTTP Index 模块 <a target="_blank" rel="noopener noreferrer" href="">ngx_http_index_module</a></li><li>HTTP Referer 模块 <a target="_blank" rel="noopener noreferrer" href="http://nginx.org/en/docs/http/ngx_http_referer_module.html">ngx_http_referer_module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>HTTP Limit Zone 模块</li><li>HTTP Limit Requests 模块 <a target="_blank" rel="noopener noreferrer" href="">ngx_http_limit_req_module</a></li><li>Log <a target="_blank" rel="noopener noreferrer" href="http://tengine.taobao.org/nginx_docs/cn/docs/http/ngx_http_log_module.html">ngx_http_log_module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>Map*</li><li>Memcached <a target="_blank" rel="noopener noreferrer" href="">ngx_http_memcached_module</a></li><li>HTTP Proxy 模块 <a target="_blank" rel="noopener noreferrer" href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">ngx_http_proxy_module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>Rewrite</li><li>SSI 模块</li><li>User ID <a target="_blank" rel="noopener noreferrer" href="">ngx_http_userid_module</a></li></ul></li><li>其他模块<ul><li>HTTP Addition 模块 <a target="_blank" rel="noopener noreferrer" href="">ngx_http_addition_module</a></li><li>Embedded Perl*</li><li>FLV <a target="_blank" rel="noopener noreferrer" href="">ngx_http_flv_module</a></li><li>Gzip Precompression</li><li>Random Index</li><li>GeoIP</li><li>Real IP <a target="_blank" rel="noopener noreferrer" href="http://nginx.org/en/docs/http/ngx_http_realip_module.html">ngx_http_realip_module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>SSL <a target="_blank" rel="noopener noreferrer" href="">ngx_http_ssl_module</a></li><li>Stub Status</li><li>Substitution</li><li>WebDAV</li><li>Google Perftools</li><li>XSLT*</li><li>Secure Link</li><li>Image Filer <a target="_blank" rel="noopener noreferrer" href="">ngx_http_image_filter_module</a></li></ul></li><li>邮件模块<ul><li>Mail Core 模块 <a target="_blank" rel="noopener noreferrer" href="">ngx_mail_core_module</a></li><li>Mail Auth 模块 <a target="_blank" rel="noopener noreferrer" href="">ngx_mail_auth_http_module</a></li><li>Mail Proxy 模块 <a target="_blank" rel="noopener noreferrer" href="">ngx_mail_proxy_module</a></li><li>Mail SSL 模块 <a target="_blank" rel="noopener noreferrer" href="">ngx_mail_ssl_module</a></li></ul></li></ul><h2 id="upstream"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//server/nginx/modules#upstream"><span class="icon,icon-link"></span></a>upstream</h2><p><code>upstream</code> 为 Nginx 内置模块，用于定义上游服务器（指的是后台提供的应用服务器）的相关信息。</p><div class="__dumi-default-code-block"><pre class="prism-code language-nginx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 语法</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">upstream</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">name</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 示例</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">upstream</span><span class="token plain"> back_end_server </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">server</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token number">.100</span><span class="token number">.33</span><span class="token punctuation">:</span><span class="token number">8081</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>在 <code>upstream</code> 内可使用的指令：</p><table><thead><tr><th align="left">指令</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left"><code>server</code></td><td align="left">定义上游服务器地址</td></tr><tr><td align="left"><code>zone</code></td><td align="left">定义共享内存，用于跨 <code>worker</code> 子进程</td></tr><tr><td align="left"><code>keepalive</code></td><td align="left">对上游服务启用长连接</td></tr><tr><td align="left"><code>keepalive_requests</code></td><td align="left">一个长连接最多请求 HTTP 的个数</td></tr><tr><td align="left"><code>keepalive_timeout</code></td><td align="left">空闲情形下，一个长连接的超时时长</td></tr><tr><td align="left"><code>hash</code></td><td align="left">哈希负载均衡算法</td></tr><tr><td align="left"><code>ip_hash</code></td><td align="left">依据 IP 进行哈希计算的负载均衡算法</td></tr><tr><td align="left"><code>least_conn</code></td><td align="left">最少连接数负载均衡算法</td></tr><tr><td align="left"><code>least_time</code></td><td align="left">最短响应时间负载均衡算法</td></tr><tr><td align="left"><code>random</code></td><td align="left">随机负载均衡算法</td></tr></tbody></table><h3 id="server"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//server/nginx/modules#server"><span class="icon,icon-link"></span></a>server</h3><p>定义上游服务器</p><div class="__dumi-default-code-block"><pre class="prism-code language-nginx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 语法</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">srver </span><span class="token operator">&lt;</span><span class="token plain">address</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">parameters</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><code>parameters</code> 可选值：</p><ul><li><code>weight=number</code>  权重值，默认为 1</li><li><code>max_conns=number</code>  上游服务器的最大并发连接数</li><li><code>fail_timeout=time</code>  服务器不可用的判定时间</li><li><code>max_fails=numer</code>  服务器不可用的检查次数</li><li><code>backup</code>  备份服务器，仅当其他服务器都不可用时才会启用</li><li><code>down</code>  标记服务器长期不可用，离线维护</li></ul><h3 id="keepalive"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//server/nginx/modules#keepalive"><span class="icon,icon-link"></span></a>keepalive</h3><h3 id="keepalive_requests"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//server/nginx/modules#keepalive_requests"><span class="icon,icon-link"></span></a>keepalive_requests</h3><h3 id="keepalive_timeout"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//server/nginx/modules#keepalive_timeout"><span class="icon,icon-link"></span></a>keepalive_timeout</h3><h2 id="proxy_pass"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//server/nginx/modules#proxy_pass"><span class="icon,icon-link"></span></a>proxy_pass</h2><p>用于配制代理服务器</p><p>可用上下文：<code>location</code>、<code>if</code>、<code>limit_except</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-nginx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 语法</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">proxy_pass</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">URL</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 示例</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">proxy_pass</span><span class="token plain"> </span><span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8081</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">proxy_pass</span><span class="token plain"> </span><span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">/</span><span class="token keyword">proxy</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><code>URL</code> 参数原则：</p><ol><li><code>URL</code> 必须以 <code>http</code> 或 <code>https</code> 开头</li><li><code>URL</code> 中可以携带变量</li><li><code>URL</code> 中是否带 <code>URI</code>，会直接影响发往上游请求的 <code>URL</code></li></ol><p>接下来我们看看两种常见的 <code>URL</code> 用法：</p><ol><li><code>proxy_pass http://192.168.100.33:8001</code></li><li><code>proxy_pass http://192.168.100.33:8001/</code></li></ol><p>这两种用法的区别就是带 <code>/</code> 和不带 <code>/</code>，在配置代理时它们的区别可大了：</p><ul><li>不带 <code>/</code> 意味着 Nginx 不会修改用户 <code>URL</code>，而是直接透传给上游的应用服务器</li><li>带 <code>/</code> 意味着 Nginx 会修改用户 <code>URL</code>，修改方案是将 <code>location</code> 后的 <code>URL</code> 从用户 <code>URL</code> 中删除</li></ul><p>不带 <code>/</code> 的用法：</p><div class="__dumi-default-code-block"><pre class="prism-code language-nginx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">location</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain">bbs</span><span class="token operator">/</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">proxy_pass</span><span class="token plain"> </span><span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8080</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>分析：</p><ol><li>用户请求 <code>URL</code>：<code>/bbs/abc/test.html</code></li><li>请求到达 Nginx 的 <code>URL</code>：<code>/bbs/abc/test.html</code></li><li>请求到达上游应用服务器的 <code>URL</code>：<code>/bbs/abc/test.html</code></li></ol><p>带 <code>/</code> 的用法：</p><div class="__dumi-default-code-block"><pre class="prism-code language-nginx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">location</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain">bbs</span><span class="token operator">/</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">proxy_pass</span><span class="token plain"> </span><span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8080</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>分析：</p><ol><li>用户请求 <code>URL</code>：<code>/bbs/abc/test.html</code></li><li>请求到达 Nginx 的 <code>URL</code>：<code>/bbs/abc/test.html</code></li><li>请求到达上游应用服务器的 <code>URL</code>：<code>/abc/test.html</code></li></ol><p>并没有接上 <code>/bbs</code>，这点和 <code>root</code> 与 <code>alias</code> 之间的区别是保持一致的。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook/edit/master/docs/server/nginx/modules.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last update: ">2/21/2022 13:40:01</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/devops-guidebook/umi.js"></script>
    <script src="/devops-guidebook/docs__server__nginx__modules.md.js"></script>
  </body>
</html>
